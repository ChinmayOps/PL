//server.js

const express = require('express');
const app = express();
app.use(express.json());
app.use(express.static('public'));
app.post('/register', (req,res)=>{
    console.log(req.body);
    res.status(201).json({massage: 'User registered successfully'}); 
});
app.listen(3000,()=>{
    console.log('Server is running on port 3000');
});

//All inside public
//app.js

document.getElementById("registrationForm").addEventListener('submit', function(e){
    e.preventDefault(); // Prevent the default form submission

    const userData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value
    }

    const xhr = new XMLHttpRequest();
    xhr.open('POST', 'http://localhost:3000/register', true);
    xhr.setRequestHeader('Content-Type', 'application/json');

    xhr.onload = function(){
        if(xhr.status === 201 || xhr.status === 200){
            let users = JSON.parse(localStorage.getItem('users')) || [];
            const exists = users.some(user => user.email === userData.email);

            if(!exists){
                users.push(userData);
                localStorage.setItem('users', JSON.stringify(users));
                window.location.href = 'list.html';
            }else{
                alert('User already exists!');
            }
        }else{
            alert('Error');
        }
    };
    xhr.send(JSON.stringify(userData));
});

//index.html

<!DOCTYPE html> <html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>User Registration</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    form { max-width: 400px; margin: auto; }
    input, button { width: 100%; padding: 10px; margin: 8px 0; }
  </style> </head>
<body>

  <h2>User Registration</h2>
  <form id="registerForm">
    <input type="text" id="name" placeholder="Name" required />
    <input type="email" id="email" placeholder="Email" required />
    <input type="password" id="password" placeholder="Password" required />
    <button type="submit">Register</button>
  </form>

  <p><a href="list.html">View Registered Users</a></p>
  <p><a href="login.html">Already registered? Login here</a></p>

  <script>
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const user = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value
      };

      // Validate email
      const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-z]{2,}$/;
      if (!emailPattern.test(user.email)) {
        alert('Enter a valid email address.');
        return;
      }

      // Check for duplicate email
      const isDuplicate = users.some(u => u.email === user.email);
      if (isDuplicate) {
      alert('This email is already registered!');
      return;}

      let users = JSON.parse(localStorage.getItem('users')) || [];
      if (users.some(u => u.email === user.email)) {
        alert('This email is already registered!');
        return;
      }

      // Send AJAX request to backend
      const xhr = new XMLHttpRequest();
      xhr.open('POST', '/register', true);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onload = function () {
        if (xhr.status === 201 || xhr.status === 200) {
          users.push(user);
          localStorage.setItem('users', JSON.stringify(users));
          alert('User registered successfully!');
          window.location.href = 'login.html';
        } else {
          alert('Server error. Try again.');
        }
      };
      xhr.send(JSON.stringify(user));
    });
  </script></body></html>

//login.html

<!DOCTYPE html> <html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>User Login</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    form { max-width: 400px; margin: auto; }
    input, button { width: 100%; padding: 10px; margin: 8px 0; }
  </style>
</head>
<body>

  <h2>User Login</h2>
  <form id="loginForm">
    <input type="email" id="email" placeholder="Email" required />
    <input type="password" id="password" placeholder="Password" required />
    <button type="submit">Login</button>
  </form>

  <p><a href="index.html">Don't have an account? Register here</a></p>

  <script>
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const users = JSON.parse(localStorage.getItem('users')) || [];

      const user = users.find(u => u.email === email && u.password === password);
      if (user) {
        localStorage.setItem('loggedInUser', JSON.stringify(user));
        alert('Login successful!');
        window.location.href = 'main.html';
      } else {
        alert('Invalid email or password!');
      }
    }); </script></body></html>

//list.html

<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Registered Users</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    h1 { text-align: center; }
    ul { list-style: none; padding: 0; }
    li { background: #f2f2f2; margin: 5px 0; padding: 10px; border-radius: 4px; }
    button { display: block; margin: 20px auto; padding: 10px 20px; }
  </style>
</head>
<body>

  <h1>Registered Users</h1>
  <ul id="userList"></ul>
  <button id="clearButton">Clear All Users</button>

  <script>
    const users = JSON.parse(localStorage.getItem('users')) || [];
    const userList = document.getElementById('userList');

    if (users.length === 0) {
      userList.innerHTML = '<p>No users found.</p>';
    } else {
      users.forEach(user => {
        const li = document.createElement('li');
        li.textContent = `Name: ${user.name}, Email: ${user.email}`;
        userList.appendChild(li);
      }); }

    document.getElementById('clearButton').addEventListener('click', function () {
      if (confirm('Are you sure you want to delete all users?')) {
        localStorage.removeItem('users');
        location.reload();
      }
    }); </script> </body> </html>

//main.html
<!DOCTYPE html> <html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Welcome Page</title>
  <style>
    body { font-family: Arial; text-align: center; padding: 20px; }
    .welcome { font-size: 20px; margin-top: 30px; }
    button { padding: 10px 20px; margin-top: 20px; }
  </style>
</head>
<body>

  <h1>Welcome to the Dashboard</h1>
  <div class="welcome" id="welcomeMsg"></div>

  <button onclick="logout()">Logout</button>

  <script>
    const user = JSON.parse(localStorage.getItem('loggedInUser'));
    if (!user) {
      alert('Please login first.');
      window.location.href = 'login.html';
    } else {
      document.getElementById('welcomeMsg').textContent = `Hello, ${user.name}!`;
    }

    function logout() {
      localStorage.removeItem('loggedInUser');
      window.location.href = 'login.html';
    } </script> </body> </html>
